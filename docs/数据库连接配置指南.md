# ğŸ—„ï¸ æ•°æ®åº“è¿æ¥é…ç½®æŒ‡å—

## ğŸ¯ å½“å‰çŠ¶æ€ï¼šæµ‹è¯•è´¦æˆ·æ¨¡å¼

**ä½ ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€ä»»ä½•æ•°æ®åº“é…ç½®ï¼**

### æµ‹è¯•è´¦æˆ·ä¿¡æ¯
- **é‚®ç®±**: `test@example.com`
- **å¯†ç **: `password`
- **è®¿é—®**: `http://localhost:3000/test-auth`

è¿™æ˜¯ç¡¬ç¼–ç åœ¨ä»£ç ä¸­çš„æµ‹è¯•è´¦æˆ·ï¼Œä¸éœ€è¦æ•°æ®åº“ã€‚

## ğŸš€ å‡çº§åˆ°çœŸå®æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨ Supabaseï¼ˆæ¨èï¼‰

#### æ­¥éª¤1ï¼šåˆ›å»º Supabase é¡¹ç›®
1. è®¿é—® [supabase.com](https://supabase.com)
2. åˆ›å»ºæ–°é¡¹ç›®
3. è·å–é¡¹ç›® URL å’Œ API Key

#### æ­¥éª¤2ï¼šé…ç½®ç¯å¢ƒå˜é‡
```env
# .env.local
NEXT_PUBLIC_SUPABASE_URL="https://your-project.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY="your-anon-key"
SUPABASE_SERVICE_ROLE_KEY="your-service-role-key"
```

#### æ­¥éª¤3ï¼šä¿®æ”¹è®¤è¯é€»è¾‘
```typescript
// src/lib/auth.ts ä¸­çš„ authorize å‡½æ•°
async authorize(credentials) {
  if (!credentials?.email || !credentials?.password) {
    return null
  }

  // ğŸ”„ æ›¿æ¢æµ‹è¯•è´¦æˆ·ä¸º Supabase è®¤è¯
  const { createClient } = require('@supabase/supabase-js')
  const supabase = createClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL,
    process.env.SUPABASE_SERVICE_ROLE_KEY
  )

  const { data, error } = await supabase.auth.signInWithPassword({
    email: credentials.email,
    password: credentials.password,
  })

  if (data.user && !error) {
    return {
      id: data.user.id,
      email: data.user.email,
      name: data.user.user_metadata?.name || data.user.email,
    }
  }

  return null
}
```

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨è‡ªå»ºæ•°æ®åº“

#### æ­¥éª¤1ï¼šå®‰è£…æ•°æ®åº“ä¾èµ–
```bash
npm install prisma @prisma/client bcryptjs
npm install -D @types/bcryptjs
```

#### æ­¥éª¤2ï¼šé…ç½® Prisma
```prisma
// prisma/schema.prisma
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
}
```

#### æ­¥éª¤3ï¼šä¿®æ”¹è®¤è¯é€»è¾‘
```typescript
// src/lib/auth.ts ä¸­çš„ authorize å‡½æ•°
async authorize(credentials) {
  if (!credentials?.email || !credentials?.password) {
    return null
  }

  // ğŸ”„ æ›¿æ¢æµ‹è¯•è´¦æˆ·ä¸ºæ•°æ®åº“æŸ¥è¯¢
  const { PrismaClient } = require('@prisma/client')
  const bcrypt = require('bcryptjs')
  const prisma = new PrismaClient()

  const user = await prisma.user.findUnique({
    where: { email: credentials.email }
  })

  if (user && await bcrypt.compare(credentials.password, user.password)) {
    return {
      id: user.id,
      email: user.email,
      name: user.name,
    }
  }

  return null
}
```

## ğŸ¯ æ¨èæ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | å¤æ‚åº¦ | æˆæœ¬ | ç»´æŠ¤ | æ¨èåº¦ |
|------|--------|------|------|--------|
| **æµ‹è¯•è´¦æˆ·** | â­ | å…è´¹ | æ—  | ğŸ¯ å¼€å‘æµ‹è¯• |
| **Supabase** | â­â­ | å…è´¹é¢åº¦ | ä½ | ğŸ¯ ç”Ÿäº§æ¨è |
| **è‡ªå»ºæ•°æ®åº“** | â­â­â­â­ | æœåŠ¡å™¨è´¹ç”¨ | é«˜ | ğŸ¯ ä¼ä¸šçº§ |

## ğŸš€ æˆ‘çš„å»ºè®®

### é˜¶æ®µ1ï¼šå­¦ä¹ å’Œå¼€å‘ï¼ˆå½“å‰ï¼‰
**ä½¿ç”¨æµ‹è¯•è´¦æˆ·** - æ— éœ€ä»»ä½•é…ç½®ï¼Œä¸“æ³¨å­¦ä¹  NextAuth

### é˜¶æ®µ2ï¼šåŸå‹å’Œæ¼”ç¤º
**å‡çº§åˆ° Supabase** - 5åˆ†é’Ÿé…ç½®ï¼Œæ”¯æŒçœŸå®ç”¨æˆ·æ³¨å†Œ

### é˜¶æ®µ3ï¼šç”Ÿäº§éƒ¨ç½²
**æ ¹æ®éœ€æ±‚é€‰æ‹©** - Supabaseï¼ˆç®€å•ï¼‰æˆ–è‡ªå»ºï¼ˆæ§åˆ¶ï¼‰

## ğŸ”§ éœ€è¦æˆ‘å¸®ä½ å‡çº§å—ï¼Ÿ

å¦‚æœä½ æƒ³å‡çº§åˆ°çœŸå®æ•°æ®åº“ï¼Œå‘Šè¯‰æˆ‘ä½ é€‰æ‹©å“ªä¸ªæ–¹æ¡ˆï¼Œæˆ‘æ¥å¸®ä½ ä¿®æ”¹ä»£ç ï¼

**å½“å‰ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨æµ‹è¯•è´¦æˆ·ä½“éªŒæ‰€æœ‰åŠŸèƒ½ã€‚** ğŸ‰ 